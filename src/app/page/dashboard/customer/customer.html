<div class="bg-[#FBFBFC] p-4 md:p-10 font-sans antialiased text-slate-900">
  <div class="max-w-7xl mx-auto space-y-8">
    <header class="flex flex-col md:flex-row md:items-center justify-between gap-6">
      <div>
        <h1 class="text-3xl font-semibold tracking-tight text-slate-900">Customers</h1>
        <p class="text-slate-500 text-sm mt-1">
          Manage registration details, salaries, and client locations.
        </p>
      </div>
      <div class="flex flex-wrap items-center gap-3">
        <div class="relative group">
          <span
            class="absolute inset-y-0 left-3.5 flex items-center text-slate-400 group-focus-within:text-blue-500 transition-colors"
          >
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
              />
            </svg>
          </span>
          <input
            type="text"
            [value]="searchQuery()"
            (input)="onSearch($event)"
            placeholder="Search customers..."
            class="pl-10 pr-4 py-2 bg-white border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none w-full md:w-64 text-sm transition-all shadow-sm"
          />
        </div>
        <button
          (click)="openModal()"
          class="bg-slate-900 hover:bg-slate-800 text-white px-5 py-2 rounded-xl text-sm font-medium flex items-center gap-2 transition-all active:scale-[0.98]"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 6v6m0 0v6m0-6h6m-6 0H6"
            />
          </svg>
          Add Customer
        </button>
      </div>
    </header>

    <div class="bg-white border border-slate-200 rounded-3xl shadow-sm overflow-hidden">
      <div class="overflow-x-auto">
        <table class="w-full text-sm text-left border-collapse">
          <thead>
            <tr
              class="bg-slate-50/50 border-b border-slate-100 text-slate-400 font-medium uppercase text-[10px] tracking-widest"
            >
              <th class="px-8 py-5">Identity</th>
              <th class="px-8 py-5">Birth Date</th>
              <th class="px-8 py-5">Location</th>
              <th class="px-8 py-5">Salary</th>
              <th class="px-8 py-5 text-right">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-slate-50">
            @if (isLoading()) {
              @for (i of [1, 2, 3, 4, 5]; track i) {
                <tr class="animate-pulse">
                  <td class="px-8 py-6"><div class="h-10 w-40 bg-slate-100 rounded-lg"></div></td>
                  <td class="px-8 py-6"><div class="h-4 w-24 bg-slate-100 rounded"></div></td>
                  <td class="px-8 py-6"><div class="h-4 w-32 bg-slate-100 rounded"></div></td>
                  <td class="px-8 py-6"><div class="h-4 w-20 bg-slate-100 rounded"></div></td>
                  <td class="px-8 py-6">
                    <div class="h-8 w-16 bg-slate-100 rounded-lg ml-auto"></div>
                  </td>
                </tr>
              }

            } @else if (errorMessage()) {
              <tr>
                <td colspan="5" class="py-20 text-center">
                  <div class="flex flex-col items-center gap-4">
                    <div
                      class="h-12 w-12 bg-red-50 text-red-500 rounded-2xl flex items-center justify-center"
                    >
                      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                        />
                      </svg>
                    </div>
                    <div>
                      <h3 class="text-slate-900 font-bold">Backend Unreachable</h3>
                      <p class="text-slate-400 text-sm mt-1">{{ errorMessage() }}</p>
                    </div>
                    <button
                      (click)="retry()"
                      class="mt-2 px-4 py-2 bg-slate-900 text-white text-xs font-bold rounded-xl hover:bg-slate-800 transition-all shadow-lg shadow-slate-200"
                    >
                      Retry Connection
                    </button>
                  </div>
                </td>
              </tr>

            } @else {
              @for (c of customerList(); track c.id) {
                <tr class="hover:bg-slate-50/50 transition-colors group cursor-default"></tr>
              } @empty {
                <tr>
                  <td colspan="5" class="py-24 text-center text-slate-400 text-sm font-medium">
                    No results found.
                  </td>
                </tr>
              }
            }
          </tbody>
        </table>
      </div>

      <footer
        class="bg-slate-50/50 px-8 py-4 border-t border-slate-100 flex items-center justify-between"
      >
        <span class="text-[11px] font-bold text-slate-400 uppercase tracking-widest">
          {{ totalElements() }} Total Entries
        </span>

        <div class="flex items-center gap-4">
          <div class="flex gap-1">
            <button
              [disabled]="page() === 0"
              (click)="goToPage(page() - 1)"
              class="p-2 text-slate-500 hover:bg-white hover:shadow-sm rounded-lg disabled:opacity-20 transition-all border border-transparent hover:border-slate-200"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
            </button>
            <button
              [disabled]="page() >= totalPages() - 1"
              (click)="goToPage(page() + 1)"
              class="p-2 text-slate-500 hover:bg-white hover:shadow-sm rounded-lg disabled:opacity-20 transition-all border border-transparent hover:border-slate-200"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </button>
          </div>
          <span class="text-xs font-semibold text-slate-600">
            {{ page() + 1 }} <span class="text-slate-300 mx-1">/</span> {{ totalPages() }}
          </span>
        </div>
      </footer>
    </div>
  </div>

  @if (showModal()) {
    <div class="fixed inset-0 z-100 flex items-center justify-center p-4">
      <div
        class="absolute inset-0 bg-slate-900/30 backdrop-blur-md"
        (click)="closeModal()"
        (keydown)="closeModal()"
      ></div>
      <div class="bg-white rounded-4xl shadow-2xl w-full max-w-lg relative z-10 overflow-hidden">
        <div class="px-10 py-8 border-b border-slate-50 flex justify-between items-center">
          <h3 class="text-xl font-semibold text-slate-900">
            {{ isEditMode() ? 'Edit Customer' : 'Add New Customer' }}
          </h3>
          <button
            (click)="closeModal()"
            class="text-slate-400 hover:text-slate-900 transition-colors"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"
              />
            </svg>
          </button>
        </div>
        <form [formGroup]="customerForm" (ngSubmit)="saveCustomer()" class="p-10 space-y-6">
          <div class="grid grid-cols-4 gap-4">
            <div class="col-span-1">
              <label
                for="customer-title"
                class="block text-[10px] font-bold text-slate-400 uppercase mb-2 tracking-wider"
                >Title</label
              >
              <input
                id="customer-title"
                formControlName="title"
                placeholder="Mr."
                class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm transition-all"
              />
            </div>
            <div class="col-span-3">
              <label
                for="customer-name"
                class="block text-[10px] font-bold text-slate-400 uppercase mb-2 tracking-wider"
                >Full Name</label
              >
              <input
                id="customer-name"
                formControlName="name"
                class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm transition-all"
                [class.border-red-400]="
                  customerForm.get('name')?.invalid && customerForm.get('name')?.touched
                "
              />
            </div>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label
                for="customer-dob"
                class="block text-[10px] font-bold text-slate-400 uppercase mb-2 tracking-wider"
                >Date of Birth</label
              >
              <input
                id="customer-dob"
                type="date"
                formControlName="dob"
                class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm transition-all"
              />
            </div>
            <div>
              <label
                for="customer-salary"
                class="block text-[10px] font-bold text-slate-400 uppercase mb-2 tracking-wider"
                >Salary</label
              >
              <input
                id="customer-salary"
                type="number"
                formControlName="salary"
                class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm font-mono transition-all"
              />
            </div>
          </div>
          <div>
            <label
              for="customer-address"
              class="block text-[10px] font-bold text-slate-400 uppercase mb-2 tracking-wider"
              >Address</label
            >
            <input
              id="customer-address"
              formControlName="address"
              placeholder="Street Name"
              class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm transition-all"
            />
          </div>
          <div class="grid grid-cols-3 gap-3">
            <input
              formControlName="city"
              placeholder="City"
              class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm transition-all"
            />
            <input
              formControlName="province"
              placeholder="State"
              class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm transition-all"
            />
            <input
              formControlName="postalCode"
              placeholder="Zip"
              class="w-full px-4 py-2.5 bg-slate-50/50 border border-slate-200 rounded-xl focus:ring-4 focus:ring-blue-500/5 focus:border-blue-500 outline-none text-sm transition-all uppercase"
            />
          </div>
          <div class="flex gap-3 pt-6">
            <button
              type="button"
              (click)="closeModal()"
              class="flex-1 px-6 py-3 text-sm font-semibold text-slate-500 hover:bg-slate-50 rounded-xl transition-all"
            >
              Cancel
            </button>
            <button
              type="submit"
              [disabled]="customerForm.invalid"
              class="flex-1 bg-slate-900 text-white px-6 py-3 rounded-xl text-sm font-semibold shadow-lg shadow-slate-200 disabled:opacity-20 transition-all active:scale-[0.98]"
            >
              {{ isEditMode() ? 'Save Changes' : 'Create Record' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  }
</div>
